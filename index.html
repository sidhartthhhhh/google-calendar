<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar System Prototype</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }
        .day-cell {
            min-height: 120px;
        }
        /* Custom scrollbar for better aesthetics */
        .event-container::-webkit-scrollbar {
            width: 4px;
        }
        .event-container::-webkit-scrollbar-thumb {
            background-color: #9ca3af;
            border-radius: 20px;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div id="app" class="p-4 md:p-8 max-w-7xl mx-auto">
        <!-- Header -->
        <div class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-4">
                <h1 class="text-2xl md:text-3xl font-bold text-gray-900" id="current-month-year"></h1>
                <div class="flex items-center gap-2">
                    <button id="prev-month" class="p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                    </button>
                    <button id="next-month" class="p-2 rounded-full hover:bg-gray-200 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                    </button>
                    <button id="today-btn" class="px-4 py-2 text-sm font-medium bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50">Today</button>
                </div>
            </div>
            <button id="create-event-btn" class="px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transition-all">
                Create Event
            </button>
        </div>

        <!-- Calendar Grid -->
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <!-- Day Headers -->
            <div class="grid grid-cols-7 text-center font-semibold text-gray-600 border-b">
                <div class="py-3">Sun</div>
                <div class="py-3">Mon</div>
                <div class="py-3">Tue</div>
                <div class="py-3">Wed</div>
                <div class="py-3">Thu</div>
                <div class="py-3">Fri</div>
                <div class="py-3">Sat</div>
            </div>
            <!-- Day Cells -->
            <div id="calendar-grid" class="calendar-grid">
                <!-- Day cells will be generated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Event Creation Modal -->
    <div id="event-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl p-8 w-full max-w-md transform transition-all scale-95 opacity-0">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900">Create New Event</h2>
                <button id="close-modal-btn" class="p-2 rounded-full hover:bg-gray-200">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <form id="event-form">
                <div class="mb-4">
                    <label for="event-title" class="block text-sm font-medium text-gray-700 mb-1">Event Title</label>
                    <input type="text" id="event-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="mb-4">
                    <label for="event-date" class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                    <input type="date" id="event-date" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                </div>
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <label for="start-time" class="block text-sm font-medium text-gray-700 mb-1">Start Time</label>
                        <input type="time" id="start-time" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="end-time" class="block text-sm font-medium text-gray-700 mb-1">End Time</label>
                        <input type="time" id="end-time" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                </div>
                <div class="flex justify-end gap-4">
                    <button type="button" id="cancel-modal-btn" class="px-4 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg hover:bg-gray-300">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700">Save Event</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- STATE ---
            let currentDate = new Date();
            // In-memory store for events. In a real app, this would come from a database.
            const events = [
                { id: 1, date: '2025-07-25', start: '10:00', end: '11:00', title: 'Design Review' },
                { id: 2, date: '2025-07-28', start: '14:00', end: '15:30', title: 'Sprint Planning' },
                { id: 3, date: new Date().toISOString().slice(0, 10), start: '09:00', end: '09:30', title: 'Daily Standup' },
            ];
            let nextEventId = 4;

            // --- DOM ELEMENTS ---
            const calendarGrid = document.getElementById('calendar-grid');
            const currentMonthYear = document.getElementById('current-month-year');
            const prevMonthBtn = document.getElementById('prev-month');
            const nextMonthBtn = document.getElementById('next-month');
            const todayBtn = document.getElementById('today-btn');
            const createEventBtn = document.getElementById('create-event-btn');
            const eventModal = document.getElementById('event-modal');
            const modalContent = eventModal.querySelector('div');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const cancelModalBtn = document.getElementById('cancel-modal-btn');
            const eventForm = document.getElementById('event-form');
            const eventDateInput = document.getElementById('event-date');

            // --- FUNCTIONS ---

            /**
             * Renders the calendar grid for the month of the given date.
             */
            const renderCalendar = () => {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();

                // Update header
                currentMonthYear.textContent = `${currentDate.toLocaleString('default', { month: 'long' })} ${year}`;
                calendarGrid.innerHTML = '';

                const firstDayOfMonth = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();

                // Add empty cells for days before the 1st of the month
                for (let i = 0; i < firstDayOfMonth; i++) {
                    const emptyCell = document.createElement('div');
                    emptyCell.className = 'day-cell border-t border-r bg-gray-50';
                    calendarGrid.appendChild(emptyCell);
                }

                // Add cells for each day of the month
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayCell = document.createElement('div');
                    const date = new Date(year, month, day);
                    const dateStr = date.toISOString().slice(0, 10);

                    dayCell.className = 'day-cell border-t border-r p-2 flex flex-col cursor-pointer hover:bg-blue-50 transition-colors';
                    dayCell.dataset.date = dateStr;

                    const dayNumber = document.createElement('span');
                    dayNumber.textContent = day;
                    dayNumber.className = 'font-medium text-gray-800 self-start';

                    // Highlight today's date
                    const today = new Date();
                    if (date.toDateString() === today.toDateString()) {
                        dayNumber.className += ' bg-blue-600 text-white rounded-full w-8 h-8 flex items-center justify-center';
                    }
                    
                    dayCell.appendChild(dayNumber);

                    // Add events for this day
                    const eventsForDay = events
                        .filter(e => e.date === dateStr)
                        .sort((a,b) => a.start.localeCompare(b.start));

                    if (eventsForDay.length > 0) {
                        const eventContainer = document.createElement('div');
                        eventContainer.className = 'mt-1 space-y-1 overflow-y-auto event-container';
                        eventsForDay.forEach(event => {
                            const eventEl = document.createElement('div');
                            eventEl.className = 'bg-blue-100 text-blue-800 text-xs font-semibold p-1 rounded truncate';
                            eventEl.textContent = `${event.start} ${event.title}`;
                            eventContainer.appendChild(eventEl);
                        });
                        dayCell.appendChild(eventContainer);
                    }
                    
                    calendarGrid.appendChild(dayCell);
                }
            };
            
            /**
             * Shows or hides the event creation modal with a smooth transition.
             * @param {boolean} show - Whether to show or hide the modal.
             * @param {string|null} dateStr - The date string to pre-fill in the form.
             */
            const toggleModal = (show, dateStr = null) => {
                if (show) {
                    if(dateStr) {
                       eventDateInput.value = dateStr;
                    } else {
                       eventDateInput.value = new Date().toISOString().slice(0, 10);
                    }
                    eventModal.classList.remove('hidden');
                    setTimeout(() => {
                        modalContent.classList.remove('scale-95', 'opacity-0');
                    }, 10);
                } else {
                    modalContent.classList.add('scale-95', 'opacity-0');
                    setTimeout(() => {
                        eventModal.classList.add('hidden');
                        eventForm.reset();
                    }, 200);
                }
            };


            // --- EVENT LISTENERS ---

            prevMonthBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                renderCalendar();
            });

            nextMonthBtn.addEventListener('click', () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                renderCalendar();
            });

            todayBtn.addEventListener('click', () => {
                currentDate = new Date();
                renderCalendar();
            });

            createEventBtn.addEventListener('click', () => toggleModal(true));
            closeModalBtn.addEventListener('click', () => toggleModal(false));
            cancelModalBtn.addEventListener('click', () => toggleModal(false));
            
            // Open modal when a day cell is clicked
            calendarGrid.addEventListener('click', (e) => {
                const cell = e.target.closest('.day-cell');
                if (cell && cell.dataset.date) {
                    toggleModal(true, cell.dataset.date);
                }
            });

            // Handle new event form submission
            eventForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const title = document.getElementById('event-title').value;
                const date = document.getElementById('event-date').value;
                const startTime = document.getElementById('start-time').value;
                const endTime = document.getElementById('end-time').value;

                if (new Date(`1970-01-01T${endTime}`) <= new Date(`1970-01-01T${startTime}`)) {
                    alert('End time must be after start time.');
                    return;
                }

                const newEvent = {
                    id: nextEventId++,
                    date: date,
                    start: startTime,
                    end: endTime,
                    title: title
                };

                events.push(newEvent);
                renderCalendar();
                toggleModal(false);
            });

            // --- INITIAL RENDER ---
            renderCalendar();
        });
    </script>
</body>
</html>
